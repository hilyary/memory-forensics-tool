# æé•œ LensAnalysis - æ‰“åŒ…è¯´æ˜

æœ¬æ–‡æ¡£è¯´æ˜å¦‚ä½•å°† LensAnalysis æ‰“åŒ…æˆç‹¬ç«‹çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚

## ğŸ“¦ æ‰“åŒ…é€‰é¡¹å¯¹æ¯”

| é€‰é¡¹ | é…ç½®æ–‡ä»¶ | é¢„ä¼°ä½“ç§¯ | è¯´æ˜ |
|------|----------|----------|------|
| **å®Œæ•´ç‰ˆ** | `build.spec` | 40-80 MB | åŒ…å« Volatility 3ï¼Œç‹¬ç«‹è¿è¡Œï¼Œæ¨è |
| **æœ€å°ç‰ˆ** | `build_minimal.spec` | 15-30 MB | ä¸å« Volatility 3ï¼Œç”¨æˆ·éœ€å®‰è£… |

### æ¨èæ–¹æ¡ˆ

- **ä¸ªäººä½¿ç”¨/å†…éƒ¨åˆ†å‘**: ä½¿ç”¨**å®Œæ•´ç‰ˆ**ï¼ˆ`build.spec`ï¼‰
- **å…¬å¼€å‘å¸ƒ/ç½‘ç»œåˆ†å‘**: ä½¿ç”¨**æœ€å°ç‰ˆ**ï¼ˆ`build_minimal.spec`ï¼‰

## ç¯å¢ƒå‡†å¤‡

### 1. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### 2. å®‰è£… PyInstaller

```bash
pip install pyinstaller
```

### 3. ï¼ˆå¯é€‰ï¼‰å®‰è£… UPX å‹ç¼©å·¥å…·

UPX å¯ä»¥è¿›ä¸€æ­¥å‡å°å¯æ‰§è¡Œæ–‡ä»¶ä½“ç§¯ 30-50%ï¼š

**Windows**:
```bash
# ä¸‹è½½ UPX: https://upx.github.io/
# å°† upx.exe æ”¾åˆ°ç³»ç»Ÿ PATH ä¸­
```

**macOS**:
```bash
brew install upx
```

**Linux**:
```bash
sudo apt install upx  # Debian/Ubuntu
sudo yum install upx  # Fedora/RHEL
```

## æ‰“åŒ…æ­¥éª¤

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨æ‰“åŒ…è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
python build.py
```

è¿™ä¸ªè„šæœ¬ä¼šè‡ªåŠ¨ï¼š
1. æ£€æŸ¥ä¾èµ–æ˜¯å¦å®‰è£…
2. æ¸…ç†æ—§çš„æ„å»ºæ–‡ä»¶
3. æ‰§è¡Œæ‰“åŒ…ï¼ˆé»˜è®¤ä½¿ç”¨å®Œæ•´ç‰ˆï¼‰
4. ç”Ÿæˆè¯´æ˜æ–‡æ¡£

### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨æ‰“åŒ…

#### å®Œæ•´ç‰ˆï¼ˆåŒ…å« Volatility 3ï¼‰- æ¨è

```bash
PyInstaller build.spec
```

**ç‰¹ç‚¹**:
- åŒ…å«å®Œæ•´çš„ Volatility 3 æ¡†æ¶
- ç”¨æˆ·æ— éœ€é¢å¤–å®‰è£…ä¾èµ–
- ä½“ç§¯è¾ƒå¤§ä½†ä½¿ç”¨æ–¹ä¾¿

#### æœ€å°ç‰ˆï¼ˆä¸å« Volatility 3ï¼‰

```bash
PyInstaller build_minimal.spec
```

**ç‰¹ç‚¹**:
- ä¸åŒ…å« Volatility 3ï¼Œä½“ç§¯å°
- ç”¨æˆ·éœ€è¦å…ˆå®‰è£… Volatility 3: `pip install volatility3`
- é€‚åˆç½‘ç»œåˆ†å‘æˆ–å¯¹ä½“ç§¯æ•æ„Ÿçš„åœºæ™¯

## æ‰“åŒ…åæ–‡ä»¶

### Windows

| ç‰ˆæœ¬ | è¾“å‡º | å¤§å° |
|------|------|------|
| å®Œæ•´ç‰ˆ | `dist/LensAnalysis/` æ–‡ä»¶å¤¹ | 40-80 MB |
| æœ€å°ç‰ˆ | `dist/LensAnalysis.exe` | 15-30 MB |

**è¿è¡Œæ–¹å¼**: åŒå‡» `LensAnalysis.exe`

### macOS

| ç‰ˆæœ¬ | è¾“å‡º | å¤§å° |
|------|------|------|
| å®Œæ•´ç‰ˆ | `dist/LensAnalysis.app` | 50-80 MB |
| æœ€å°ç‰ˆ | `dist/LensAnalysis.app` | 20-30 MB |

**è¿è¡Œæ–¹å¼**: åŒå‡» `LensAnalysis.app`

**æ³¨æ„**: å¯èƒ½éœ€è¦åœ¨"ç³»ç»Ÿåå¥½è®¾ç½® > å®‰å…¨æ€§ä¸éšç§"ä¸­å…è®¸è¿è¡Œ

### Linux

| ç‰ˆæœ¬ | è¾“å‡º | å¤§å° |
|------|------|------|
| å®Œæ•´ç‰ˆ | `dist/LensAnalysis/` æ–‡ä»¶å¤¹ | 40-70 MB |
| æœ€å°ç‰ˆ | `dist/LensAnalysis` | 15-25 MB |

**è¿è¡Œæ–¹å¼**:
```bash
chmod +x dist/LensAnalysis
./dist/LensAnalysis
```

## æ‰“åŒ…é…ç½®

### build.spec é…ç½®æ–‡ä»¶

ä¸»è¦é…ç½®é¡¹ï¼š
- `datas`: å‰ç«¯æ–‡ä»¶ï¼ˆHTML/CSS/JSï¼‰
- `hiddenimports`: éšå¼å¯¼å…¥çš„æ¨¡å—
- `excludes`: æ’é™¤çš„æ¨¡å—ï¼ˆå‡å°ä½“ç§¯ï¼‰
- `console`: æ˜¯å¦æ˜¾ç¤ºæ§åˆ¶å°çª—å£ï¼ˆFalse=éšè—ï¼‰

## æ‰“åŒ…åŸç†

### å¼€å‘ç¯å¢ƒ vs æ‰“åŒ…ç¯å¢ƒ

| é¡¹ç›® | å¼€å‘ç¯å¢ƒ | æ‰“åŒ…ç¯å¢ƒ |
|------|----------|----------|
| Volatility è°ƒç”¨ | `vol` å‘½ä»¤ | `python -m volatility3` |
| æ–‡ä»¶è·¯å¾„ | `__file__` | `sys.executable` |
| å‰ç«¯æ–‡ä»¶ | ç›¸å¯¹è·¯å¾„ | ä¸´æ—¶è§£å‹ç›®å½• |

### æ£€æµ‹æ‰“åŒ…ç¯å¢ƒ

ä»£ç ä½¿ç”¨ `sys.frozen` æ£€æµ‹æ˜¯å¦åœ¨æ‰“åŒ…ç¯å¢ƒä¸­è¿è¡Œï¼š

```python
is_frozen = getattr(sys, 'frozen', False)
if is_frozen:
    # æ‰“åŒ…ç¯å¢ƒ
    python_exe = sys.executable
else:
    # å¼€å‘ç¯å¢ƒ
    python_exe = 'python'
```

## æ‰“åŒ…åæ³¨æ„äº‹é¡¹

### 1. ç”¨æˆ·æ•°æ®ç›®å½•

ç¨‹åºé¦–æ¬¡è¿è¡Œä¼šåˆ›å»ºç”¨æˆ·æ•°æ®ç›®å½•ï¼š

- **macOS**: `~/Library/Application Support/LensAnalysis/`
- **Windows**: `%APPDATA%/LensAnalysis/`
- **Linux**: `~/.local/share/LensAnalysis/`

åŒ…å«ï¼š
- `symbols/` - ç¬¦å·è¡¨æ–‡ä»¶
- `cache/` - é•œåƒç¼“å­˜
- `logs/` - æ—¥å¿—æ–‡ä»¶
- `reports/` - åˆ†ææŠ¥å‘Š

### 2. ç¬¦å·è¡¨ç®¡ç†

æ‰“åŒ…åçš„ç¨‹åºä¸åŒ…å«ç¬¦å·è¡¨ï¼Œéœ€è¦ç”¨æˆ·å•ç‹¬ä¸‹è½½ï¼š
- ä½¿ç”¨ç¨‹åºå†…ç½®çš„ç¬¦å·è¡¨ç®¡ç†å™¨ä¸‹è½½
- æˆ–æ‰‹åŠ¨å°†ç¬¦å·è¡¨å¤åˆ¶åˆ°ç”¨æˆ·æ•°æ®ç›®å½•çš„ `symbols/` æ–‡ä»¶å¤¹

### 3. Volatility 3 ä¾èµ–

æ‰“åŒ…åçš„ç¨‹åºåŒ…å« Volatility 3 æ¡†æ¶ï¼Œä½†ï¼š
- ç¡®ä¿æ‰“åŒ…æ—¶ Volatility 3 å·²æ­£ç¡®å®‰è£…
- è‡ªå®šä¹‰æ’ä»¶ä¼šè¢«æ‰“åŒ…è¿›å¯æ‰§è¡Œæ–‡ä»¶

## åˆ†å‘å»ºè®®

### Windows

#### é€‰é¡¹ 1: ç›´æ¥åˆ†å‘ exe
- ä¼˜ç‚¹ï¼šç®€å•ç›´æ¥
- ç¼ºç‚¹ï¼šå•æ–‡ä»¶è¾ƒå¤§

#### é€‰é¡¹ 2: ä½¿ç”¨ Inno Setup åˆ›å»ºå®‰è£…ç¨‹åº
```iss
[Setup]
AppName=æé•œ LensAnalysis
AppVersion=1.0.0
DefaultDirName={pf}\LensAnalysis
DefaultGroupName=LensAnalysis
OutputBaseFilename=LensAnalysis-Setup

[Files]
Source: "dist\LensAnalysis.exe"; DestDir: "{app}"
Source: "README.md"; DestDir: "{app}"

[Icons]
Name: "{group}\æé•œ LensAnalysis"; Filename: "{app}\LensAnalysis.exe"
```

### macOS

#### é€‰é¡¹ 1: ç›´æ¥åˆ†å‘ .app
- å¯ä»¥ç›´æ¥æ‹–æ‹½åˆ°åº”ç”¨ç¨‹åºæ–‡ä»¶å¤¹

#### é€‰é¡¹ 2: åˆ›å»º DMG é•œåƒ
```bash
hdiutil create -volname "LensAnalysis" \
  -srcfolder dist/LensAnalysis.app \
  -ov -format UDZO \
  dist/LensAnalysis.dmg
```

#### é€‰é¡¹ 3: ä»£ç ç­¾åï¼ˆæ¨èï¼‰
```bash
codesign --deep --force \
  --sign "Developer ID Application: Your Name" \
  dist/LensAnalysis.app
```

### Linux

#### é€‰é¡¹ 1: AppImageï¼ˆæ¨èï¼‰
è·¨å‘è¡Œç‰ˆé€šç”¨æ ¼å¼

#### é€‰é¡¹ 2: åˆ›å»º deb åŒ…ï¼ˆDebian/Ubuntuï¼‰
ä½¿ç”¨ `fpm` æˆ– `dpkg-deb`

#### é€‰é¡¹ 3: åˆ›å»º rpm åŒ…ï¼ˆFedora/RHELï¼‰
ä½¿ç”¨ `fpm` æˆ– `rpmbuild`

## å¸¸è§é—®é¢˜

### 1. æ‰“åŒ…åç¨‹åºæ— æ³•è¿è¡Œ

**ç—‡çŠ¶**: åŒå‡» exe æ²¡æœ‰ååº”

**è§£å†³**:
- ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ
- æ£€æŸ¥æ€æ¯’è½¯ä»¶æ˜¯å¦æ‹¦æˆª
- ä½¿ç”¨å‘½ä»¤è¡Œè¿è¡ŒæŸ¥çœ‹é”™è¯¯ä¿¡æ¯

### 2. Volatility æ’ä»¶æ‰¾ä¸åˆ°

**ç—‡çŠ¶**: æç¤ºæ’ä»¶ä¸å­˜åœ¨

**è§£å†³**:
- ç¡®ä¿æ‰“åŒ…æ—¶ `hiddenimports` åŒ…å«æ‰€æœ‰ Volatility æ’ä»¶
- æ£€æŸ¥ `backend/plugins` æ˜¯å¦æ­£ç¡®æ‰“åŒ…

### 3. å‰ç«¯æ–‡ä»¶æ— æ³•åŠ è½½

**ç—‡çŠ¶**: çª—å£æ‰“å¼€ä½†é¡µé¢ç©ºç™½

**è§£å†³**:
- æ£€æŸ¥ `build.spec` ä¸­ `datas` æ˜¯å¦æ­£ç¡®é…ç½®
- ç¡®ä¿ä½¿ç”¨ `sys._MEIPASS` è·å–èµ„æºè·¯å¾„

### 4. ç¬¦å·è¡¨ä¸‹è½½å¤±è´¥

**ç—‡çŠ¶**: æç¤ºç½‘ç»œé”™è¯¯

**è§£å†³**:
- æ£€æŸ¥ä»£ç†è®¾ç½®
- æ‰‹åŠ¨ä¸‹è½½ç¬¦å·è¡¨å¹¶å¤åˆ¶åˆ°ç”¨æˆ·æ•°æ®ç›®å½•

## ä¼˜åŒ–å»ºè®®

### 1. å‡å°ä½“ç§¯

- ä½¿ç”¨ UPX å‹ç¼©ï¼ˆå·²å¯ç”¨ï¼‰
- æ’é™¤ä¸éœ€è¦çš„æ¨¡å—
- å•æ–‡ä»¶æ‰“åŒ…ï¼ˆ`onefile=True`ï¼‰ä½†å¯åŠ¨ä¼šå˜æ…¢

### 2. åŠ å¿«å¯åŠ¨é€Ÿåº¦

- ä½¿ç”¨ `onedir` æ¨¡å¼è€Œä¸æ˜¯ `onefile`
- é¢„ç¼–è¯‘ .pyc æ–‡ä»¶
- å»¶è¿ŸåŠ è½½éå¿…è¦æ¨¡å—

### 3. æå‡å®‰å…¨æ€§

- ä»£ç ç­¾å
- åŠ å¯†ï¼ˆ`cipher=block_cipher`ï¼‰
- æ··æ·†

## è‡ªåŠ¨åŒ–æ‰“åŒ…

### GitHub Actions

åˆ›å»º `.github/workflows/build.yml`:

```yaml
name: Build

on:
  push:
    tags:
      - 'v*'

jobs:
  build:
    strategy:
      matrix:
        os: [windows-latest, macos-latest, ubuntu-latest]
    runs-on: ${{ matrix.os }}
    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-python@v2
        with:
          python-version: '3.9'
      - run: pip install -r requirements.txt
      - run: python build.py
      - uses: actions/upload-artifact@v2
        with:
          name: LensAnalysis-${{ matrix.os }}
          path: dist/
```

## è®¸å¯è¯

æ‰“åŒ…åçš„ç¨‹åºéœ€éµå®ˆä»¥ä¸‹è®¸å¯è¯ï¼š
- Volatility 3: VSL v1.0
- PyWebView: BSD-3-Clause
- å…¶ä»–ç¬¬ä¸‰æ–¹åº“çš„å„è‡ªè®¸å¯è¯
